(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79887,e=>{"use strict";e.s(["default",()=>V],79887);var s=e.i(18050),a=e.i(71645),t=e.i(18566),l=e.i(49786),n=e.i(81868),r=e.i(70065),i=e.i(94179),o=e.i(67881),c=e.i(81947),d=e.i(23750),h=e.i(10708),m=e.i(62870),x=e.i(25959),u=e.i(91432),j=e.i(54858);e.i(73827);var p=e.i(59467),g=e.i(46696),v=e.i(27341),f=e.i(47627),N=e.i(30374),b=e.i(63415),y=e.i(58041),C=e.i(52786),w=e.i(16715),T=e.i(7233),D=e.i(27612),S=e.i(40160),k=e.i(69638),I=e.i(73884),F=e.i(78894),A=e.i(31278),P=e.i(52571),B=e.i(98919),z=e.i(75505),M=e.i(68553),H=e.i(67240),L=e.i(69074),R=e.i(31343),Z=e.i(52044),E=e.i(23585);let q=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);function O(e){if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB","PB"][s]}function V(){let e=(0,t.useRouter)(),{user:V,isAuthenticated:_,isLoading:U}=(0,u.useAuth)(),[K,G]=(0,a.useState)(null),[Q,J]=(0,a.useState)([]),[W,X]=(0,a.useState)([]),[Y,$]=(0,a.useState)([]),[ee,es]=(0,a.useState)([]),[ea,et]=(0,a.useState)([]),[el,en]=(0,a.useState)(null),[er,ei]=(0,a.useState)(!0),[eo,ec]=(0,a.useState)(!1),[ed,eh]=(0,a.useState)(!1),[em,ex]=(0,a.useState)(!1),[eu,ej]=(0,a.useState)(!1),[ep,eg]=(0,a.useState)(!1),[ev,ef]=(0,a.useState)(!1),[eN,eb]=(0,a.useState)(!1),[ey,eC]=(0,a.useState)({name:"",vdev_type:"stripe",devices:[],mountpoint:"",force:!1}),[ew,eT]=(0,a.useState)({name:"",mountpoint:"",compression:"lz4",quota:""}),[eD,eS]=(0,a.useState)({dataset:"",name:"",recursive:!1}),[ek,eI]=(0,a.useState)(!1),[eF,eA]=(0,a.useState)(!1),[eP,eB]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!U){if(!_)return void e.replace("/");V&&"user"===V.role&&e.replace("/dashboard")}},[U,_,V,e]);let ez=async()=>{try{let e=await j.zfsAPI.getStatus();if(G(e),e.installed&&e.kernel_module){let[e,s,a,t]=await Promise.all([j.zfsAPI.listPools().catch(()=>[]),j.zfsAPI.listDatasets().catch(()=>[]),j.zfsAPI.listSnapshots().catch(()=>[]),j.zfsAPI.getAvailableDisks().catch(()=>[])]);J(e),X(s),$(a),es(t);try{let e=await j.zfsAPI.listImportablePools();et(e)}catch(e){et([])}}}catch(e){g.toast.error("Failed to load ZFS data: ".concat(e))}finally{ei(!1),ec(!1)}};(0,a.useEffect)(()=>{_&&(null==V?void 0:V.role)==="admin"&&ez()},[_,V]);let eM=async()=>{eh(!0);try{let e=await j.zfsAPI.loadModule();g.toast.success(e.message),ez()}catch(e){g.toast.error("Failed to load ZFS module: ".concat(e))}finally{eh(!1)}},eH=async()=>{if(!ey.name||0===ey.devices.length)return void g.toast.error("Pool name and at least one device are required");eI(!0);try{await j.zfsAPI.createPool({name:ey.name,vdev_type:ey.vdev_type,devices:ey.devices,mountpoint:ey.mountpoint||void 0,force:ey.force}),g.toast.success("Pool ".concat(ey.name," created successfully")),ex(!1),eC({name:"",vdev_type:"stripe",devices:[],mountpoint:"",force:!1}),ez()}catch(e){g.toast.error("Failed to create pool: ".concat(e))}finally{eI(!1)}},eL=async e=>{if(confirm('Are you sure you want to destroy pool "'.concat(e,'"? This will DELETE ALL DATA in the pool!')))try{await j.zfsAPI.destroyPool(e,!0),g.toast.success("Pool ".concat(e," destroyed")),ez()}catch(e){g.toast.error("Failed to destroy pool: ".concat(e))}},eR=async(e,s)=>{try{await j.zfsAPI.scrubPool(e,s),g.toast.success("Scrub ".concat(s,"ed for pool ").concat(e)),ez()}catch(e){g.toast.error("Failed to ".concat(s," scrub: ").concat(e))}},eZ=async e=>{if(confirm('Export pool "'.concat(e,'"? It will be unmounted and made unavailable.')))try{await j.zfsAPI.exportPool(e),g.toast.success("Pool ".concat(e," exported")),ez()}catch(e){g.toast.error("Failed to export pool: ".concat(e))}},eE=async e=>{try{await j.zfsAPI.importPool(e),g.toast.success(e?"Pool ".concat(e," imported"):"All pools imported"),eb(!1),ez()}catch(e){g.toast.error("Failed to import pool: ".concat(e))}},eq=async e=>{try{let s=await j.zfsAPI.getPoolStatus(e);en(s),ef(!0)}catch(e){g.toast.error("Failed to get pool status: ".concat(e))}},eO=async()=>{if(!ew.name)return void g.toast.error("Dataset name is required (format: pool/dataset)");eA(!0);try{await j.zfsAPI.createDataset({name:ew.name,mountpoint:ew.mountpoint||void 0,compression:ew.compression||void 0,quota:ew.quota||void 0}),g.toast.success("Dataset ".concat(ew.name," created successfully")),ej(!1),eT({name:"",mountpoint:"",compression:"lz4",quota:""}),ez()}catch(e){g.toast.error("Failed to create dataset: ".concat(e))}finally{eA(!1)}},eV=async e=>{if(confirm('Are you sure you want to destroy dataset "'.concat(e,'"? This will DELETE ALL DATA!')))try{await j.zfsAPI.destroyDataset(e,!0,!0),g.toast.success("Dataset ".concat(e," destroyed")),ez()}catch(e){g.toast.error("Failed to destroy dataset: ".concat(e))}},e_=async()=>{if(!eD.dataset||!eD.name)return void g.toast.error("Dataset and snapshot name are required");eB(!0);try{await j.zfsAPI.createSnapshot(eD.dataset,eD.name,eD.recursive),g.toast.success("Snapshot created successfully"),eg(!1),eS({dataset:"",name:"",recursive:!1}),ez()}catch(e){g.toast.error("Failed to create snapshot: ".concat(e))}finally{eB(!1)}},eU=async e=>{if(confirm('Delete snapshot "'.concat(e,'"?')))try{await j.zfsAPI.deleteSnapshot(e),g.toast.success("Snapshot ".concat(e," deleted")),ez()}catch(e){g.toast.error("Failed to delete snapshot: ".concat(e))}},eK=async e=>{if(confirm('Rollback to snapshot "'.concat(e,'"? This will revert the dataset to this point in time and destroy all newer snapshots!')))try{await j.zfsAPI.rollbackSnapshot(e,!0,!1,!0),g.toast.success("Rolled back to snapshot ".concat(e)),ez()}catch(e){g.toast.error("Failed to rollback: ".concat(e))}};return U&&!V||!_||V&&"admin"!==V.role||er?(0,s.jsx)(p.PageSkeleton,{title:"ZFS Storage"}):(0,s.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,s.jsx)(n.Sidebar,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(l.Header,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"ZFS Storage Management"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage ZFS pools, datasets, and snapshots"})]}),(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{ec(!0),ez()},disabled:eo,children:[(0,s.jsx)(w.RefreshCw,{className:"h-4 w-4 mr-2 ".concat(eo?"animate-spin":"")}),"Refresh"]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(y.Database,{className:"h-10 w-10 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.CardTitle,{className:"text-lg",children:"ZFS (Zettabyte File System)"}),(0,s.jsx)(r.CardDescription,{children:"Advanced storage management with data integrity"})]})]}),(null==K?void 0:K.installed)&&(null==K?void 0:K.kernel_module)?(0,s.jsx)(k.CheckCircle,{className:"h-8 w-8 text-green-500"}):(null==K?void 0:K.installed)?(0,s.jsx)(F.AlertTriangle,{className:"h-8 w-8 text-yellow-500"}):(0,s.jsx)(I.XCircle,{className:"h-8 w-8 text-muted-foreground"})]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(null==K?void 0:K.installed)?(null==K?void 0:K.kernel_module)?(0,s.jsx)(i.Badge,{variant:"default",className:"bg-green-600",children:"Ready"}):(0,s.jsx)(i.Badge,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Module Not Loaded"}):(0,s.jsx)(i.Badge,{variant:"secondary",children:"Not Installed"}),(null==K?void 0:K.version)&&(0,s.jsxs)(i.Badge,{variant:"outline",children:["v",K.version]}),Q.length>0&&(0,s.jsxs)(i.Badge,{variant:"secondary",children:[Q.length," pool(s)"]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:null==K?void 0:K.message}),(null==K?void 0:K.installed)?(null==K?void 0:K.kernel_module)?null:(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(o.Button,{onClick:eM,disabled:ed,children:ed?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading Module..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q,{className:"h-4 w-4 mr-2"}),"Load ZFS Kernel Module"]})})}):(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsxs)(c.Alert,{children:[(0,s.jsx)(B.Shield,{className:"h-4 w-4"}),(0,s.jsx)(c.AlertTitle,{children:"Manual Installation Required"}),(0,s.jsxs)(c.AlertDescription,{children:["ZFS must be installed manually by the system administrator. Run the following command as root to install:",(0,s.jsx)("code",{className:"block mt-2 p-2 bg-muted rounded text-xs",children:(null==K?void 0:K.package_manager)==="apt"?"sudo apt install ".concat((null==K?void 0:K.package_name)||"zfsutils-linux"):"sudo dnf install ".concat((null==K?void 0:K.package_name)||"zfs")}),(0,s.jsx)("p",{className:"mt-2 text-xs text-muted-foreground",children:"Note: ZFS installation may require kernel headers and DKMS. Please refer to the ZFS documentation for your distribution."})]})]})})]})]}),(null==K?void 0:K.installed)&&(null==K?void 0:K.kernel_module)&&(0,s.jsxs)(v.Tabs,{defaultValue:"pools",className:"space-y-4",children:[(0,s.jsxs)(v.TabsList,{children:[(0,s.jsxs)(v.TabsTrigger,{value:"pools",className:"gap-2",children:[(0,s.jsx)(C.HardDrive,{className:"h-4 w-4"}),"Pools",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:Q.length})]}),(0,s.jsxs)(v.TabsTrigger,{value:"datasets",className:"gap-2",children:[(0,s.jsx)(z.FolderOpen,{className:"h-4 w-4"}),"Datasets",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:W.length})]}),(0,s.jsxs)(v.TabsTrigger,{value:"snapshots",className:"gap-2",children:[(0,s.jsx)(M.Camera,{className:"h-4 w-4"}),"Snapshots",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:Y.length})]})]}),(0,s.jsxs)(v.TabsContent,{value:"pools",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Storage Pools"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[ea.length>0&&(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>eb(!0),children:[(0,s.jsx)(L.Upload,{className:"h-4 w-4 mr-2"}),"Import Pool (",ea.length,")"]}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>ex(!0),children:[(0,s.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Create Pool"]})]})]}),0===Q.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(C.HardDrive,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No ZFS pools configured"}),(0,s.jsx)("p",{className:"text-sm",children:"Create a pool to get started with ZFS storage"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(f.Table,{children:[(0,s.jsx)(f.TableHeader,{children:(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableHead,{children:"Name"}),(0,s.jsx)(f.TableHead,{children:"Size"}),(0,s.jsx)(f.TableHead,{children:"Used"}),(0,s.jsx)(f.TableHead,{children:"Free"}),(0,s.jsx)(f.TableHead,{children:"Health"}),(0,s.jsx)(f.TableHead,{children:"Fragmentation"}),(0,s.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(f.TableBody,{children:Q.map(e=>(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableCell,{className:"font-medium",children:e.name}),(0,s.jsx)(f.TableCell,{children:O(e.size)}),(0,s.jsx)(f.TableCell,{children:O(e.allocated)}),(0,s.jsx)(f.TableCell,{children:O(e.free)}),(0,s.jsx)(f.TableCell,{children:(e=>{switch(e.toUpperCase()){case"ONLINE":return(0,s.jsx)(i.Badge,{variant:"default",className:"bg-green-600",children:"ONLINE"});case"DEGRADED":return(0,s.jsx)(i.Badge,{variant:"default",className:"bg-yellow-600",children:"DEGRADED"});case"FAULTED":return(0,s.jsx)(i.Badge,{variant:"destructive",children:"FAULTED"});case"OFFLINE":return(0,s.jsx)(i.Badge,{variant:"secondary",children:"OFFLINE"});default:return(0,s.jsx)(i.Badge,{variant:"outline",children:e})}})(e.health)}),(0,s.jsx)(f.TableCell,{children:e.fragmentation}),(0,s.jsx)(f.TableCell,{className:"text-right",children:(0,s.jsxs)(b.DropdownMenu,{children:[(0,s.jsx)(b.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(E.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(b.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eq(e.name),children:[(0,s.jsx)(P.Info,{className:"h-4 w-4 mr-2"}),"View Status"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eR(e.name,"start"),children:[(0,s.jsx)(R.Play,{className:"h-4 w-4 mr-2"}),"Start Scrub"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eR(e.name,"stop"),children:[(0,s.jsx)(Z.Square,{className:"h-4 w-4 mr-2"}),"Stop Scrub"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eZ(e.name),children:[(0,s.jsx)(S.Download,{className:"h-4 w-4 mr-2"}),"Export Pool"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eL(e.name),className:"text-red-600",children:[(0,s.jsx)(D.Trash2,{className:"h-4 w-4 mr-2"}),"Destroy Pool"]})]})]})})]},e.name))})]})})]}),(0,s.jsxs)(v.TabsContent,{value:"datasets",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Datasets"}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>ej(!0),disabled:0===Q.length,children:[(0,s.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Create Dataset"]})]}),0===W.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(z.FolderOpen,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No datasets found"}),(0,s.jsx)("p",{className:"text-sm",children:"Create a pool first, then add datasets"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(f.Table,{children:[(0,s.jsx)(f.TableHeader,{children:(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableHead,{children:"Name"}),(0,s.jsx)(f.TableHead,{children:"Used"}),(0,s.jsx)(f.TableHead,{children:"Available"}),(0,s.jsx)(f.TableHead,{children:"Mountpoint"}),(0,s.jsx)(f.TableHead,{children:"Compression"}),(0,s.jsx)(f.TableHead,{children:"Quota"}),(0,s.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(f.TableBody,{children:W.map(e=>(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableCell,{className:"font-medium font-mono text-sm",children:e.name}),(0,s.jsx)(f.TableCell,{children:O(e.used)}),(0,s.jsx)(f.TableCell,{children:O(e.available)}),(0,s.jsx)(f.TableCell,{className:"font-mono text-sm",children:e.mountpoint}),(0,s.jsx)(f.TableCell,{children:(0,s.jsx)(i.Badge,{variant:"outline",children:e.compression})}),(0,s.jsx)(f.TableCell,{children:e.quota?"number"==typeof e.quota?O(e.quota):e.quota:"-"}),(0,s.jsx)(f.TableCell,{className:"text-right",children:(0,s.jsxs)(b.DropdownMenu,{children:[(0,s.jsx)(b.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(E.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(b.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>{eS({dataset:e.name,name:"",recursive:!1}),eg(!0)},children:[(0,s.jsx)(M.Camera,{className:"h-4 w-4 mr-2"}),"Create Snapshot"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eV(e.name),className:"text-red-600",children:[(0,s.jsx)(D.Trash2,{className:"h-4 w-4 mr-2"}),"Destroy Dataset"]})]})]})})]},e.name))})]})})]}),(0,s.jsxs)(v.TabsContent,{value:"snapshots",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Snapshots"}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>eg(!0),disabled:0===W.length,children:[(0,s.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Create Snapshot"]})]}),0===Y.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(M.Camera,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No snapshots found"}),(0,s.jsx)("p",{className:"text-sm",children:"Create snapshots to preserve point-in-time copies of your data"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(f.Table,{children:[(0,s.jsx)(f.TableHeader,{children:(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableHead,{children:"Name"}),(0,s.jsx)(f.TableHead,{children:"Dataset"}),(0,s.jsx)(f.TableHead,{children:"Used"}),(0,s.jsx)(f.TableHead,{children:"Referenced"}),(0,s.jsx)(f.TableHead,{children:"Created"}),(0,s.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(f.TableBody,{children:Y.map(e=>(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableCell,{className:"font-medium font-mono text-sm",children:e.name}),(0,s.jsx)(f.TableCell,{className:"font-mono text-sm",children:e.dataset}),(0,s.jsx)(f.TableCell,{children:O(e.used)}),(0,s.jsx)(f.TableCell,{children:O(e.referenced)}),(0,s.jsx)(f.TableCell,{children:e.creation}),(0,s.jsx)(f.TableCell,{className:"text-right",children:(0,s.jsxs)(b.DropdownMenu,{children:[(0,s.jsx)(b.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(E.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(b.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eK(e.name),children:[(0,s.jsx)(H.RotateCcw,{className:"h-4 w-4 mr-2"}),"Rollback"]}),(0,s.jsxs)(b.DropdownMenuItem,{onClick:()=>eU(e.name),className:"text-red-600",children:[(0,s.jsx)(D.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},e.name))})]})})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,s.jsx)(P.Info,{className:"h-5 w-5"}),"About ZFS"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"ZFS is an advanced filesystem and volume manager with built-in data integrity verification, copy-on-write snapshots, and RAID-Z redundancy. It combines the roles of a filesystem and volume manager, providing powerful features for data protection and storage efficiency."}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Pools"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pools combine multiple disks into a single storage unit. They can use striping, mirroring, or RAID-Z configurations for performance and redundancy."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Datasets"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Datasets are flexible filesystem containers within a pool. They share pool space and can have individual quotas, compression, and mount options."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Snapshots"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Snapshots are instant, space-efficient point-in-time copies. They only use space when data changes, making them ideal for backups and testing."})]})]})]})]})]})})]}),(0,s.jsx)(N.Dialog,{open:em,onOpenChange:ex,children:(0,s.jsxs)(N.DialogContent,{className:"max-w-lg",children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsx)(N.DialogTitle,{children:"Create ZFS Pool"}),(0,s.jsx)(N.DialogDescription,{children:"Create a new storage pool from available disks"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"pool-name",children:"Pool Name"}),(0,s.jsx)(d.Input,{id:"pool-name",placeholder:"mypool",value:ey.name,onChange:e=>eC({...ey,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"vdev-type",children:"VDEV Type"}),(0,s.jsxs)(m.Select,{value:ey.vdev_type,onValueChange:e=>eC({...ey,vdev_type:e}),children:[(0,s.jsx)(m.SelectTrigger,{children:(0,s.jsx)(m.SelectValue,{placeholder:"Select type"})}),(0,s.jsxs)(m.SelectContent,{children:[(0,s.jsx)(m.SelectItem,{value:"stripe",children:"Stripe (no redundancy)"}),(0,s.jsx)(m.SelectItem,{value:"mirror",children:"Mirror (2+ disks)"}),(0,s.jsx)(m.SelectItem,{value:"raidz1",children:"RAID-Z1 (3+ disks, 1 parity)"}),(0,s.jsx)(m.SelectItem,{value:"raidz2",children:"RAID-Z2 (4+ disks, 2 parity)"}),(0,s.jsx)(m.SelectItem,{value:"raidz3",children:"RAID-Z3 (5+ disks, 3 parity)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{children:"Available Disks"}),0===ee.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No available disks found"}):(0,s.jsx)("div",{className:"border rounded-lg max-h-48 overflow-y-auto",children:ee.filter(e=>!e.in_use).map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border-b last:border-b-0",children:[(0,s.jsx)(x.Checkbox,{id:e.path,checked:ey.devices.includes(e.path),onCheckedChange:s=>{s?eC({...ey,devices:[...ey.devices,e.path]}):eC({...ey,devices:ey.devices.filter(s=>s!==e.path)})}}),(0,s.jsxs)("label",{htmlFor:e.path,className:"flex-1 cursor-pointer",children:[(0,s.jsx)("div",{className:"font-mono text-sm",children:e.path}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[O(e.size)," - ",e.model||e.type]})]})]},e.path))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"mountpoint",children:"Mount Point (optional)"}),(0,s.jsx)(d.Input,{id:"mountpoint",placeholder:"/mnt/mypool",value:ey.mountpoint,onChange:e=>eC({...ey,mountpoint:e.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Checkbox,{id:"force",checked:ey.force,onCheckedChange:e=>eC({...ey,force:!!e})}),(0,s.jsx)("label",{htmlFor:"force",className:"text-sm",children:"Force creation (use with caution)"})]})]}),(0,s.jsxs)(N.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ex(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:eH,disabled:ek||0===ey.devices.length,children:ek?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Pool"})]})]})}),(0,s.jsx)(N.Dialog,{open:eu,onOpenChange:ej,children:(0,s.jsxs)(N.DialogContent,{children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsx)(N.DialogTitle,{children:"Create Dataset"}),(0,s.jsx)(N.DialogDescription,{children:"Create a new dataset within an existing pool"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"dataset-name",children:"Dataset Name"}),(0,s.jsx)(d.Input,{id:"dataset-name",placeholder:"pool/dataset",value:ew.name,onChange:e=>eT({...ew,name:e.target.value})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Format: poolname/datasetname (e.g., mypool/documents)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"ds-mountpoint",children:"Mount Point (optional)"}),(0,s.jsx)(d.Input,{id:"ds-mountpoint",placeholder:"/mnt/mypool/documents",value:ew.mountpoint,onChange:e=>eT({...ew,mountpoint:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"compression",children:"Compression"}),(0,s.jsxs)(m.Select,{value:ew.compression,onValueChange:e=>eT({...ew,compression:e}),children:[(0,s.jsx)(m.SelectTrigger,{children:(0,s.jsx)(m.SelectValue,{placeholder:"Select compression"})}),(0,s.jsxs)(m.SelectContent,{children:[(0,s.jsx)(m.SelectItem,{value:"off",children:"Off"}),(0,s.jsx)(m.SelectItem,{value:"lz4",children:"LZ4 (recommended)"}),(0,s.jsx)(m.SelectItem,{value:"gzip",children:"GZIP"}),(0,s.jsx)(m.SelectItem,{value:"zstd",children:"ZSTD"}),(0,s.jsx)(m.SelectItem,{value:"lzjb",children:"LZJB"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"quota",children:"Quota (optional)"}),(0,s.jsx)(d.Input,{id:"quota",placeholder:"10G, 500M, etc.",value:ew.quota,onChange:e=>eT({...ew,quota:e.target.value})})]})]}),(0,s.jsxs)(N.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ej(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:eO,disabled:eF||!ew.name,children:eF?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Dataset"})]})]})}),(0,s.jsx)(N.Dialog,{open:ep,onOpenChange:eg,children:(0,s.jsxs)(N.DialogContent,{children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsx)(N.DialogTitle,{children:"Create Snapshot"}),(0,s.jsx)(N.DialogDescription,{children:"Create a point-in-time snapshot of a dataset"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"snap-dataset",children:"Dataset"}),(0,s.jsxs)(m.Select,{value:eD.dataset,onValueChange:e=>eS({...eD,dataset:e}),children:[(0,s.jsx)(m.SelectTrigger,{children:(0,s.jsx)(m.SelectValue,{placeholder:"Select dataset"})}),(0,s.jsx)(m.SelectContent,{children:W.map(e=>(0,s.jsx)(m.SelectItem,{value:e.name,children:e.name},e.name))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"snap-name",children:"Snapshot Name"}),(0,s.jsx)(d.Input,{id:"snap-name",placeholder:"snap-2024-01-01",value:eD.name,onChange:e=>eS({...eD,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Checkbox,{id:"recursive",checked:eD.recursive,onCheckedChange:e=>eS({...eD,recursive:!!e})}),(0,s.jsx)("label",{htmlFor:"recursive",className:"text-sm",children:"Recursive (include child datasets)"})]})]}),(0,s.jsxs)(N.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eg(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:e_,disabled:eP||!eD.dataset||!eD.name,children:eP?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Snapshot"})]})]})}),(0,s.jsx)(N.Dialog,{open:ev,onOpenChange:ef,children:(0,s.jsxs)(N.DialogContent,{className:"max-w-2xl",children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsxs)(N.DialogTitle,{children:["Pool Status: ",null==el?void 0:el.name]}),(0,s.jsx)(N.DialogDescription,{children:"Detailed status and configuration"})]}),el&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"State"}),(0,s.jsx)("p",{className:"font-medium",children:el.state})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Status"}),(0,s.jsx)("p",{className:"font-medium",children:el.status||"OK"})]})]}),el.scan&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Last Scan"}),(0,s.jsx)("p",{className:"text-sm",children:el.scan})]}),el.action&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Action"}),(0,s.jsx)("p",{className:"text-sm",children:el.action})]}),el.config&&el.config.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground mb-2 block",children:"Configuration"}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsxs)(f.Table,{children:[(0,s.jsx)(f.TableHeader,{children:(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableHead,{children:"Name"}),(0,s.jsx)(f.TableHead,{children:"State"}),(0,s.jsx)(f.TableHead,{children:"Read"}),(0,s.jsx)(f.TableHead,{children:"Write"}),(0,s.jsx)(f.TableHead,{children:"Cksum"})]})}),(0,s.jsx)(f.TableBody,{children:el.config.map((e,a)=>(0,s.jsxs)(f.TableRow,{children:[(0,s.jsx)(f.TableCell,{className:"font-mono text-sm",style:{paddingLeft:"".concat(16*e.indent+12,"px")},children:e.name}),(0,s.jsx)(f.TableCell,{children:e.state}),(0,s.jsx)(f.TableCell,{children:e.read}),(0,s.jsx)(f.TableCell,{children:e.write}),(0,s.jsx)(f.TableCell,{children:e.cksum})]},a))})]})})]}),el.errors&&"No known data errors"!==el.errors&&(0,s.jsxs)(c.Alert,{variant:"destructive",children:[(0,s.jsx)(F.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)(c.AlertTitle,{children:"Errors Detected"}),(0,s.jsx)(c.AlertDescription,{children:el.errors})]})]}),(0,s.jsx)(N.DialogFooter,{children:(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ef(!1),children:"Close"})})]})}),(0,s.jsx)(N.Dialog,{open:eN,onOpenChange:eb,children:(0,s.jsxs)(N.DialogContent,{children:[(0,s.jsxs)(N.DialogHeader,{children:[(0,s.jsx)(N.DialogTitle,{children:"Import ZFS Pool"}),(0,s.jsx)(N.DialogDescription,{children:"Import a previously exported or disconnected pool"})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===ea.length?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No importable pools found"}):(0,s.jsx)("div",{className:"space-y-2",children:ea.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["ID: ",e.id," - State: ",e.state]})]}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>eE(e.name),children:[(0,s.jsx)(L.Upload,{className:"h-4 w-4 mr-2"}),"Import"]})]},e.id))})}),(0,s.jsxs)(N.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eb(!1),children:"Close"}),(0,s.jsx)(o.Button,{onClick:()=>eE(),disabled:0===ea.length,children:"Import All"})]})]})})]})}}]);