(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23750,e=>{"use strict";e.s(["Input",()=>r]);var t=e.i(18050),a=e.i(47163);function r(e){let{className:r,type:s,...l}=e;return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...l})}},10708,e=>{"use strict";e.s(["Label",()=>n],10708);var t=e.i(18050),a=e.i(71645),r=e.i(48425),s=a.forwardRef((e,a)=>(0,t.jsx)(r.Primitive.label,{...e,ref:a,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));s.displayName="Label";var l=e.i(47163);function n(e){let{className:a,...r}=e;return(0,t.jsx)(s,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...r})}},30374,e=>{"use strict";e.s(["Dialog",()=>l,"DialogContent",()=>d,"DialogDescription",()=>x,"DialogFooter",()=>u,"DialogHeader",()=>c,"DialogTitle",()=>m,"DialogTrigger",()=>n],30374);var t=e.i(18050),a=e.i(26999),r=e.i(41947),r=r,s=e.i(47163);function l(e){let{...r}=e;return(0,t.jsx)(a.Root,{"data-slot":"dialog",...r})}function n(e){let{...r}=e;return(0,t.jsx)(a.Trigger,{"data-slot":"dialog-trigger",...r})}function o(e){let{...r}=e;return(0,t.jsx)(a.Portal,{"data-slot":"dialog-portal",...r})}function i(e){let{className:r,...l}=e;return(0,t.jsx)(a.Overlay,{"data-slot":"dialog-overlay",className:(0,s.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r),...l})}function d(e){let{className:l,children:n,showCloseButton:d=!0,...c}=e;return(0,t.jsxs)(o,{"data-slot":"dialog-portal",children:[(0,t.jsx)(i,{}),(0,t.jsxs)(a.Content,{"data-slot":"dialog-content",className:(0,s.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",l),...c,children:[n,d&&(0,t.jsxs)(a.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,t.jsx)(r.default,{}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function c(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"dialog-header",className:(0,s.cn)("flex flex-col gap-2 text-center sm:text-left",a),...r})}function u(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"dialog-footer",className:(0,s.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...r})}function m(e){let{className:r,...l}=e;return(0,t.jsx)(a.Title,{"data-slot":"dialog-title",className:(0,s.cn)("text-lg leading-none font-semibold",r),...l})}function x(e){let{className:r,...l}=e;return(0,t.jsx)(a.Description,{"data-slot":"dialog-description",className:(0,s.cn)("text-muted-foreground text-sm",r),...l})}},30009,e=>{"use strict";e.s(["AlertDialog",()=>R,"AlertDialogAction",()=>z,"AlertDialogCancel",()=>L,"AlertDialogContent",()=>M,"AlertDialogDescription",()=>I,"AlertDialogFooter",()=>P,"AlertDialogHeader",()=>_,"AlertDialogTitle",()=>H],30009);var t=e.i(18050),a=e.i(71645),r=e.i(20783),s=e.i(26999),l=e.i(81140),n=Symbol("radix.slottable"),o="AlertDialog",[i,d]=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=[],l=()=>{let t=s.map(e=>a.createContext(e));return function(r){let s=(null==r?void 0:r[e])||t;return a.useMemo(()=>({["__scope".concat(e)]:{...r,[e]:s}}),[r,s])}};return l.scopeName=e,[function(r,l){let n=a.createContext(l),o=s.length;s=[...s,l];let i=r=>{var s;let{scope:l,children:i,...d}=r,c=(null==l||null==(s=l[e])?void 0:s[o])||n,u=a.useMemo(()=>d,Object.values(d));return(0,t.jsx)(c.Provider,{value:u,children:i})};return i.displayName=r+"Provider",[i,function(t,s){var i;let d=(null==s||null==(i=s[e])?void 0:i[o])||n,c=a.useContext(d);if(c)return c;if(void 0!==l)return l;throw Error("`".concat(t,"` must be used within `").concat(r,"`"))}]},function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let s=t[0];if(1===t.length)return s;let l=()=>{let e=t.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(t){let r=e.reduce((e,a)=>{let{useScope:r,scopeName:s}=a,l=r(t)["__scope".concat(s)];return{...e,...l}},{});return a.useMemo(()=>({["__scope".concat(s.scopeName)]:r}),[r])}};return l.scopeName=s.scopeName,l}(l,...r)]}(o,[s.createDialogScope]),c=(0,s.createDialogScope)(),u=e=>{let{__scopeAlertDialog:a,...r}=e,l=c(a);return(0,t.jsx)(s.Root,{...l,...r,modal:!0})};u.displayName=o,a.forwardRef((e,a)=>{let{__scopeAlertDialog:r,...l}=e,n=c(r);return(0,t.jsx)(s.Trigger,{...n,...l,ref:a})}).displayName="AlertDialogTrigger";var m=e=>{let{__scopeAlertDialog:a,...r}=e,l=c(a);return(0,t.jsx)(s.Portal,{...l,...r})};m.displayName="AlertDialogPortal";var x=a.forwardRef((e,a)=>{let{__scopeAlertDialog:r,...l}=e,n=c(r);return(0,t.jsx)(s.Overlay,{...n,...l,ref:a})});x.displayName="AlertDialogOverlay";var g="AlertDialogContent",[p,f]=i(g),h=function(e){let a=e=>{let{children:a}=e;return(0,t.jsx)(t.Fragment,{children:a})};return a.displayName="".concat(e,".Slottable"),a.__radixId=n,a}("AlertDialogContent"),j=a.forwardRef((e,n)=>{let{__scopeAlertDialog:o,children:i,...d}=e,u=c(o),m=a.useRef(null),x=(0,r.useComposedRefs)(n,m),f=a.useRef(null);return(0,t.jsx)(s.WarningProvider,{contentName:g,titleName:v,docsSlug:"alert-dialog",children:(0,t.jsx)(p,{scope:o,cancelRef:f,children:(0,t.jsxs)(s.Content,{role:"alertdialog",...u,...d,ref:x,onOpenAutoFocus:(0,l.composeEventHandlers)(d.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=f.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,t.jsx)(h,{children:i}),(0,t.jsx)(A,{contentRef:m})]})})})});j.displayName=g;var v="AlertDialogTitle",b=a.forwardRef((e,a)=>{let{__scopeAlertDialog:r,...l}=e,n=c(r);return(0,t.jsx)(s.Title,{...n,...l,ref:a})});b.displayName=v;var y="AlertDialogDescription",w=a.forwardRef((e,a)=>{let{__scopeAlertDialog:r,...l}=e,n=c(r);return(0,t.jsx)(s.Description,{...n,...l,ref:a})});w.displayName=y;var D=a.forwardRef((e,a)=>{let{__scopeAlertDialog:r,...l}=e,n=c(r);return(0,t.jsx)(s.Close,{...n,...l,ref:a})});D.displayName="AlertDialogAction";var N="AlertDialogCancel",C=a.forwardRef((e,a)=>{let{__scopeAlertDialog:l,...n}=e,{cancelRef:o}=f(N,l),i=c(l),d=(0,r.useComposedRefs)(a,o);return(0,t.jsx)(s.Close,{...i,...n,ref:d})});C.displayName=N;var A=e=>{let{contentRef:t}=e,r="`".concat(g,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(g,"` by passing a `").concat(y,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(g,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return a.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},T=e.i(47163),k=e.i(67881);function R(e){let{...a}=e;return(0,t.jsx)(u,{"data-slot":"alert-dialog",...a})}function S(e){let{...a}=e;return(0,t.jsx)(m,{"data-slot":"alert-dialog-portal",...a})}function F(e){let{className:a,...r}=e;return(0,t.jsx)(x,{"data-slot":"alert-dialog-overlay",className:(0,T.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...r})}function M(e){let{className:a,...r}=e;return(0,t.jsxs)(S,{children:[(0,t.jsx)(F,{}),(0,t.jsx)(j,{"data-slot":"alert-dialog-content",className:(0,T.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...r})]})}function _(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,T.cn)("flex flex-col gap-2 text-center sm:text-left",a),...r})}function P(e){let{className:a,...r}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,T.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...r})}function H(e){let{className:a,...r}=e;return(0,t.jsx)(b,{"data-slot":"alert-dialog-title",className:(0,T.cn)("text-lg font-semibold",a),...r})}function I(e){let{className:a,...r}=e;return(0,t.jsx)(w,{"data-slot":"alert-dialog-description",className:(0,T.cn)("text-muted-foreground text-sm",a),...r})}function z(e){let{className:a,...r}=e;return(0,t.jsx)(D,{className:(0,T.cn)((0,k.buttonVariants)(),a),...r})}function L(e){let{className:a,...r}=e;return(0,t.jsx)(C,{className:(0,T.cn)((0,k.buttonVariants)({variant:"outline"}),a),...r})}},23585,88511,e=>{"use strict";e.s(["MoreVertical",()=>a],23585);var t=e.i(75254);let a=(0,t.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["Edit",()=>r],88511);let r=(0,t.default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},51364,e=>{"use strict";e.s(["default",()=>D],51364);var t=e.i(18050),a=e.i(71645),r=e.i(18566),s=e.i(49786),l=e.i(81868),n=e.i(67881),o=e.i(23750),i=e.i(94179),d=e.i(47627),c=e.i(63415),u=e.i(30374),m=e.i(30009),x=e.i(10708),g=e.i(23585);let p=(0,e.i(75254).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var f=e.i(88511),h=e.i(27612),j=e.i(16715),v=e.i(46696),b=e.i(91432),y=e.i(54858);e.i(73827);var w=e.i(59467);function D(){var e;let[D,N]=(0,a.useState)(""),[C,A]=(0,a.useState)(!1),[T,k]=(0,a.useState)([]),[R,S]=(0,a.useState)(!0),{user:F,isAuthenticated:M,isLoading:_}=(0,b.useAuth)(),P=(0,r.useRouter)(),[H,I]=(0,a.useState)(""),[z,L]=(0,a.useState)(""),[U,E]=(0,a.useState)(""),[O,B]=(0,a.useState)(!1),[q,V]=(0,a.useState)({open:!1});(0,a.useEffect)(()=>{_||M?_||(null==F?void 0:F.role)==="admin"||(P.push("/dashboard"),v.toast.error("Admin access required")):P.push("/login")},[_,M,F,P]);let K=async()=>{S(!0);try{let e=await y.usersAPI.list();k(e)}catch(e){console.error("Failed to load users:",e),v.toast.error("Failed to load users")}finally{S(!1)}};(0,a.useEffect)(()=>{M&&(null==F?void 0:F.role)==="admin"&&K()},[M,F]);let G=T.filter(e=>e.username.toLowerCase().includes(D.toLowerCase())||e.email&&e.email.toLowerCase().includes(D.toLowerCase())),W=async()=>{if(!H||!U)return void v.toast.error("Username and password are required");try{await y.usersAPI.create({username:H,password:U,email:z,is_admin:O}),v.toast.success("User created successfully"),A(!1),I(""),L(""),E(""),B(!1),K()}catch(e){console.error("Failed to create user:",e),v.toast.error("Failed to create user")}},Y=async()=>{if(q.user)try{await y.usersAPI.delete(q.user.id),v.toast.success("Deleted user: ".concat(q.user.username)),V({open:!1}),K()}catch(e){console.error("Failed to delete user:",e),v.toast.error("Failed to delete user")}},J=async e=>{if(e.id===(null==F?void 0:F.id))return void v.toast.error("Cannot modify your own admin status");try{await y.usersAPI.update(e.id,{is_admin:!e.is_admin}),v.toast.success("Updated ".concat(e.username,"'s admin status")),K()}catch(e){console.error("Failed to update user:",e),v.toast.error("Failed to update user")}};return _&&!F||!M||F&&"admin"!==F.role?(0,t.jsx)(w.PageSkeleton,{title:"User Management"}):(0,t.jsxs)("div",{className:"flex h-screen",children:[(0,t.jsx)(l.Sidebar,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,t.jsx)(s.Header,{title:"User Management"}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage user accounts and permissions"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Button,{variant:"outline",size:"icon",onClick:K,disabled:R,children:(0,t.jsx)(j.RefreshCw,{className:"h-4 w-4 ".concat(R?"animate-spin":"")})}),(0,t.jsxs)(u.Dialog,{open:C,onOpenChange:A,children:[(0,t.jsx)(u.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{children:[(0,t.jsx)(p,{className:"mr-2 h-4 w-4"}),"Add User"]})}),(0,t.jsxs)(u.DialogContent,{children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Add New User"}),(0,t.jsx)(u.DialogDescription,{children:"Create a new user account with access to the file server."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{htmlFor:"new-username",children:"Username"}),(0,t.jsx)(o.Input,{id:"new-username",placeholder:"Enter username",value:H,onChange:e=>I(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{htmlFor:"new-email",children:"Email (optional)"}),(0,t.jsx)(o.Input,{id:"new-email",type:"email",placeholder:"user@example.com",value:z,onChange:e=>L(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(x.Label,{htmlFor:"new-password",children:"Password"}),(0,t.jsx)(o.Input,{id:"new-password",type:"password",placeholder:"Enter password",value:U,onChange:e=>E(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{id:"new-is-admin",type:"checkbox",checked:O,onChange:e=>B(e.target.checked),className:"rounded border-input"}),(0,t.jsx)(x.Label,{htmlFor:"new-is-admin",children:"Admin user"})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{onClick:W,children:"Create User"})]})]})]})]})]}),(0,t.jsx)("div",{children:(0,t.jsx)(o.Input,{type:"search",placeholder:"Search users by username or email...",value:D,onChange:e=>N(e.target.value),className:"max-w-md"})}),(0,t.jsx)("div",{className:"border rounded-lg",children:R?(0,t.jsx)("div",{className:"p-8 text-center text-muted-foreground",children:"Loading users..."}):(0,t.jsxs)(d.Table,{children:[(0,t.jsx)(d.TableHeader,{children:(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableHead,{children:"Username"}),(0,t.jsx)(d.TableHead,{children:"Email"}),(0,t.jsx)(d.TableHead,{children:"Role"}),(0,t.jsx)(d.TableHead,{children:"Groups"}),(0,t.jsx)(d.TableHead,{children:"Created"}),(0,t.jsx)(d.TableHead,{className:"w-12"})]})}),(0,t.jsx)(d.TableBody,{children:G.map(e=>(0,t.jsxs)(d.TableRow,{children:[(0,t.jsx)(d.TableCell,{className:"font-medium",children:e.username}),(0,t.jsx)(d.TableCell,{children:e.email||"-"}),(0,t.jsx)(d.TableCell,{children:(0,t.jsx)(i.Badge,{variant:e.is_admin?"default":"secondary",children:e.is_admin?"admin":"user"})}),(0,t.jsx)(d.TableCell,{children:e.groups&&e.groups.length>0?e.groups.join(", "):"-"}),(0,t.jsx)(d.TableCell,{children:new Date(e.created_at).toLocaleDateString()}),(0,t.jsx)(d.TableCell,{children:(0,t.jsxs)(c.DropdownMenu,{children:[(0,t.jsx)(c.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(g.MoreVertical,{className:"h-4 w-4"})})}),(0,t.jsxs)(c.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(c.DropdownMenuItem,{onClick:()=>J(e),children:[(0,t.jsx)(f.Edit,{className:"mr-2 h-4 w-4"}),e.is_admin?"Remove Admin":"Make Admin"]}),(0,t.jsxs)(c.DropdownMenuItem,{onClick:()=>(e=>{if(e.id===(null==F?void 0:F.id))return void v.toast.error("Cannot delete your own account");V({open:!0,user:e})})(e),className:"text-destructive",children:[(0,t.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]})}),(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",G.length," of ",T.length," users"]})})]})})]}),(0,t.jsx)(m.AlertDialog,{open:q.open,onOpenChange:e=>V({...q,open:e}),children:(0,t.jsxs)(m.AlertDialogContent,{children:[(0,t.jsxs)(m.AlertDialogHeader,{children:[(0,t.jsx)(m.AlertDialogTitle,{children:"Delete User"}),(0,t.jsxs)(m.AlertDialogDescription,{children:['Are you sure you want to delete user "',null==(e=q.user)?void 0:e.username,'"? This action cannot be undone.']})]}),(0,t.jsxs)(m.AlertDialogFooter,{children:[(0,t.jsx)(m.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(m.AlertDialogAction,{onClick:Y,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}}]);