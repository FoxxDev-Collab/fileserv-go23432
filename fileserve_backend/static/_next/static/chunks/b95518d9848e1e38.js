(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,37568,e=>{"use strict";e.s(["default",()=>H]);var s=e.i(18050),l=e.i(71645),a=e.i(18566),n=e.i(49786),i=e.i(81868),r=e.i(70065),t=e.i(94179),o=e.i(67881),d=e.i(47627),c=e.i(30374),h=e.i(62870),x=e.i(27341),m=e.i(23750),u=e.i(10708),p=e.i(84762),j=e.i(19036),_=e.i(91432),g=e.i(54858);e.i(73827);var b=e.i(59467),w=e.i(46696),f=e.i(73014),v=e.i(16715),N=e.i(7233),y=e.i(88699),C=e.i(27612),S=e.i(61911),k=e.i(48256),T=e.i(84614),L=e.i(78894),B=e.i(78094),D=e.i(58524),A=e.i(18393),z=e.i(52786),I=e.i(86536);let P={share_name:"",comment:"",valid_users:"",invalid_users:"",write_list:"",read_list:"",create_mask:"0644",directory_mask:"0755",force_user:"",force_group:"",veto_files:"",inherit:!1},F={export_path:"",allowed_hosts:["*"],root_squash:!0,all_squash:!1,anon_uid:65534,anon_gid:65534,sync:!0,no_subtree_check:!0,secure:!0,fsid:""},q={public_enabled:!1,max_link_expiry:0,allow_download:!0,allow_upload:!1,allow_preview:!0,allow_listing:!0,require_auth:!0};function H(){var e,H,U,Z;let G=(0,a.useRouter)(),{user:V,isAuthenticated:M,isLoading:R}=(0,_.useAuth)(),[E,O]=(0,l.useState)([]),[W,K]=(0,l.useState)([]),[Q,Y]=(0,l.useState)([]),[J,X]=(0,l.useState)([]),[$,ee]=(0,l.useState)(!0),[es,el]=(0,l.useState)(!1),[ea,en]=(0,l.useState)(!1),[ei,er]=(0,l.useState)(!1),[et,eo]=(0,l.useState)(!1),[ed,ec]=(0,l.useState)(null),[eh,ex]=(0,l.useState)("basic"),[em,eu]=(0,l.useState)(""),[ep,ej]=(0,l.useState)(""),[e_,eg]=(0,l.useState)(""),[eb,ew]=(0,l.useState)(""),[ef,ev]=(0,l.useState)(""),[eN,ey]=(0,l.useState)({pool_id:"",name:"",path:"",description:"",zone_type:"group",enabled:!0,auto_provision:!1,allowed_users:[],allowed_groups:[],deny_users:[],deny_groups:[],allow_network_shares:!0,allow_web_shares:!0,allow_guest_access:!1,smb_enabled:!0,nfs_enabled:!1,smb_options:{...P},nfs_options:{...F},web_options:{...q},max_quota_per_user:0,read_only:!1,browsable:!0});(0,l.useEffect)(()=>{if(!R){if(!M)return void G.replace("/");V&&"user"===V.role&&G.replace("/dashboard")}},[R,M,V,G]);let eC=async()=>{try{let[e,s,l,a]=await Promise.all([g.zonesAPI.list(),g.poolsAPI.list(),g.usersAPI.list(),g.systemUsersAPI.listGroups()]);O(e||[]),K(s||[]);let n=(l||[]).map(e=>e.username),i=(a||[]).map(e=>e.name);Y(n),X(i)}catch(e){w.toast.error("Failed to load data: ".concat(e))}finally{ee(!1),el(!1)}};(0,l.useEffect)(()=>{M&&(null==V?void 0:V.role)==="admin"&&eC()},[M,V]);let eS=(e,s,l)=>{s&&!eN[e].includes(s)&&(ey(l=>({...l,[e]:[...l[e],s]})),l(""))},ek=(e,s)=>{ey(l=>({...l,[e]:l[e].filter(e=>e!==s)}))},eT=()=>{ef&&!eN.nfs_options.allowed_hosts.includes(ef)&&(ey(e=>({...e,nfs_options:{...e.nfs_options,allowed_hosts:[...e.nfs_options.allowed_hosts,ef]}})),ev(""))},eL=e=>{var s,l,a,n;ec(e),ey({pool_id:e.pool_id,name:e.name,path:e.path,description:e.description,zone_type:e.zone_type,enabled:e.enabled,auto_provision:e.auto_provision,allowed_users:e.allowed_users||[],allowed_groups:e.allowed_groups||[],deny_users:e.deny_users||[],deny_groups:e.deny_groups||[],allow_network_shares:e.allow_network_shares,allow_web_shares:e.allow_web_shares,allow_guest_access:e.allow_guest_access,smb_enabled:null==(s=e.smb_enabled)||s,nfs_enabled:null!=(l=e.nfs_enabled)&&l,smb_options:e.smb_options||{...P},nfs_options:e.nfs_options||{...F},web_options:e.web_options||{...q},max_quota_per_user:e.max_quota_per_user/1024/1024/1024,read_only:null!=(a=e.read_only)&&a,browsable:null==(n=e.browsable)||n}),ex("basic"),en(!0)},eB=async()=>{if(ed)try{var e;await g.zonesAPI.update(ed.id,{name:eN.name,description:eN.description,zone_type:eN.zone_type,enabled:eN.enabled,auto_provision:eN.auto_provision,allowed_users:eN.allowed_users,allowed_groups:eN.allowed_groups,deny_users:eN.deny_users,deny_groups:eN.deny_groups,allow_network_shares:eN.smb_enabled||eN.nfs_enabled,allow_web_shares:eN.web_options.public_enabled||eN.allow_web_shares,allow_guest_access:eN.allow_guest_access,smb_enabled:eN.smb_enabled,nfs_enabled:eN.nfs_enabled,smb_options:eN.smb_enabled?eN.smb_options:void 0,nfs_options:eN.nfs_enabled?eN.nfs_options:void 0,web_options:eN.web_options,max_quota_per_user:1024*eN.max_quota_per_user*1048576,read_only:eN.read_only,browsable:eN.browsable}),w.toast.success("Share zone updated successfully"),en(!1),ey({pool_id:(null==(e=W[0])?void 0:e.id)||"",name:"",path:"",description:"",zone_type:"group",enabled:!0,auto_provision:!1,allowed_users:[],allowed_groups:[],deny_users:[],deny_groups:[],allow_network_shares:!0,allow_web_shares:!0,allow_guest_access:!1,smb_enabled:!0,nfs_enabled:!1,smb_options:{...P},nfs_options:{...F},web_options:{...q},max_quota_per_user:0,read_only:!1,browsable:!0}),ex("basic"),ec(null),eC()}catch(e){w.toast.error("Failed to update zone: ".concat(e))}},eD=async()=>{if(ed)try{await g.zonesAPI.delete(ed.id),w.toast.success("Share zone deleted successfully"),er(!1),ec(null),eC()}catch(e){w.toast.error("Failed to delete zone: ".concat(e))}},eA=e=>{let s=W.find(s=>s.id===e);return(null==s?void 0:s.name)||"Unknown"},ez=e=>{switch(e){case"personal":return(0,s.jsxs)(t.Badge,{variant:"secondary",children:[(0,s.jsx)(T.User,{className:"h-3 w-3 mr-1"}),"Personal"]});case"group":return(0,s.jsxs)(t.Badge,{variant:"default",children:[(0,s.jsx)(S.Users,{className:"h-3 w-3 mr-1"}),"Group"]});case"public":return(0,s.jsxs)(t.Badge,{variant:"outline",children:[(0,s.jsx)(k.Globe,{className:"h-3 w-3 mr-1"}),"Public"]});default:return(0,s.jsx)(t.Badge,{children:e})}};return R&&!V||!M||V&&"admin"!==V.role||$?(0,s.jsx)(b.PageSkeleton,{title:"Storage Zones"}):(0,s.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,s.jsx)(i.Sidebar,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(n.Header,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Share Zones"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Configure zones within storage pools for different types of shares"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{el(!0),eC()},disabled:es,children:[(0,s.jsx)(v.RefreshCw,{className:"h-4 w-4 mr-2 ".concat(es?"animate-spin":"")}),"Refresh"]}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>G.push("/admin/storage/zones/create"),disabled:0===W.length,children:[(0,s.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Add Zone"]})]})]}),0===W.length&&(0,s.jsxs)(r.Card,{className:"border-yellow-500/50 bg-yellow-500/10",children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsxs)(r.CardTitle,{className:"flex items-center gap-2 text-yellow-600",children:[(0,s.jsx)(L.AlertTriangle,{className:"h-5 w-5"}),"No Storage Pools Configured"]}),(0,s.jsx)(r.CardDescription,{children:"You need to create a storage pool before you can create share zones."})]}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)(o.Button,{onClick:()=>G.push("/admin/storage/pools"),children:"Go to Storage Pools"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Total Zones"}),(0,s.jsx)(f.FolderTree,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.length})})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Personal Zones"}),(0,s.jsx)(T.User,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.filter(e=>"personal"===e.zone_type).length})})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Group Zones"}),(0,s.jsx)(S.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.filter(e=>"group"===e.zone_type).length})})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(r.CardTitle,{className:"text-sm font-medium",children:"Public Zones"}),(0,s.jsx)(k.Globe,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(r.CardContent,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:E.filter(e=>"public"===e.zone_type).length})})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsxs)(r.CardHeader,{children:[(0,s.jsx)(r.CardTitle,{children:"Share Zones"}),(0,s.jsx)(r.CardDescription,{children:"Manage share zone configurations within your storage pools"})]}),(0,s.jsx)(r.CardContent,{children:0===E.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(f.FolderTree,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium",children:"No Share Zones"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create share zones to organize where shares can be created"}),W.length>0&&(0,s.jsxs)(o.Button,{onClick:()=>G.push("/admin/storage/zones/create"),children:[(0,s.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Add Zone"]})]}):(0,s.jsxs)(d.Table,{children:[(0,s.jsx)(d.TableHeader,{children:(0,s.jsxs)(d.TableRow,{children:[(0,s.jsx)(d.TableHead,{children:"Name"}),(0,s.jsx)(d.TableHead,{children:"Pool"}),(0,s.jsx)(d.TableHead,{children:"Path"}),(0,s.jsx)(d.TableHead,{children:"Type"}),(0,s.jsx)(d.TableHead,{children:"Protocols"}),(0,s.jsx)(d.TableHead,{children:"Status"}),(0,s.jsx)(d.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(d.TableBody,{children:E.map(e=>(0,s.jsxs)(d.TableRow,{children:[(0,s.jsx)(d.TableCell,{className:"font-medium",children:(0,s.jsxs)("div",{children:[e.name,e.description&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:e.description})]})}),(0,s.jsx)(d.TableCell,{children:eA(e.pool_id)}),(0,s.jsx)(d.TableCell,{className:"font-mono text-sm",children:e.path}),(0,s.jsx)(d.TableCell,{children:ez(e.zone_type)}),(0,s.jsx)(d.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[e.smb_enabled&&(0,s.jsxs)(t.Badge,{variant:"outline",className:"text-xs px-1.5",children:[(0,s.jsx)(A.Server,{className:"h-3 w-3 mr-1"}),"SMB"]}),e.nfs_enabled&&(0,s.jsxs)(t.Badge,{variant:"outline",className:"text-xs px-1.5",children:[(0,s.jsx)(z.HardDrive,{className:"h-3 w-3 mr-1"}),"NFS"]}),e.allow_web_shares&&(0,s.jsxs)(t.Badge,{variant:"outline",className:"text-xs px-1.5",children:[(0,s.jsx)(D.Link2,{className:"h-3 w-3 mr-1"}),"Web"]}),e.allow_guest_access&&(0,s.jsx)("span",{title:"Guest Access",children:(0,s.jsx)(k.Globe,{className:"h-4 w-4 text-yellow-500"})})]})}),(0,s.jsx)(d.TableCell,{children:(0,s.jsx)(t.Badge,{variant:e.enabled?"default":"secondary",children:e.enabled?"Active":"Disabled"})}),(0,s.jsx)(d.TableCell,{className:"text-right",children:(0,s.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{ec(e),eo(!0)},title:"View Details",children:(0,s.jsx)(I.Eye,{className:"h-4 w-4"})}),(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>eL(e),title:"Edit",children:(0,s.jsx)(y.Pencil,{className:"h-4 w-4"})}),(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>{ec(e),er(!0)},title:"Delete",children:(0,s.jsx)(C.Trash2,{className:"h-4 w-4 text-red-500"})})]})})]},e.id))})]})})]})]})})]}),(0,s.jsx)(c.Dialog,{open:ea,onOpenChange:en,children:(0,s.jsxs)(c.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsxs)(c.DialogTitle,{children:["Edit Share Zone: ",null==ed?void 0:ed.name]}),(0,s.jsx)(c.DialogDescription,{children:"Configure zone settings, access control, and sharing protocols"})]}),(0,s.jsxs)(x.Tabs,{value:eh,onValueChange:ex,className:"flex-1 overflow-hidden flex flex-col",children:[(0,s.jsxs)(x.TabsList,{className:"grid w-full grid-cols-5",children:[(0,s.jsx)(x.TabsTrigger,{value:"basic",children:"Basic"}),(0,s.jsx)(x.TabsTrigger,{value:"access",children:"Access"}),(0,s.jsx)(x.TabsTrigger,{value:"smb",children:"SMB"}),(0,s.jsx)(x.TabsTrigger,{value:"nfs",children:"NFS"}),(0,s.jsx)(x.TabsTrigger,{value:"web",children:"Web"})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto py-4",children:[(0,s.jsxs)(x.TabsContent,{value:"basic",className:"mt-0 space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{children:"Storage Pool"}),(0,s.jsx)(m.Input,{value:eA(eN.pool_id),disabled:!0,className:"bg-muted"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"edit-name",children:"Zone Name"}),(0,s.jsx)(m.Input,{id:"edit-name",value:eN.name,onChange:e=>ey({...eN,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{children:"Path"}),(0,s.jsx)(m.Input,{value:eN.path,disabled:!0,className:"bg-muted"})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"edit-zone_type",children:"Zone Type"}),(0,s.jsxs)(h.Select,{value:eN.zone_type,onValueChange:e=>ey({...eN,zone_type:e}),children:[(0,s.jsx)(h.SelectTrigger,{children:(0,s.jsx)(h.SelectValue,{})}),(0,s.jsxs)(h.SelectContent,{children:[(0,s.jsx)(h.SelectItem,{value:"personal",children:"Personal"}),(0,s.jsx)(h.SelectItem,{value:"group",children:"Group"}),(0,s.jsx)(h.SelectItem,{value:"public",children:"Public"})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"edit-description",children:"Description"}),(0,s.jsx)(p.Textarea,{id:"edit-description",value:eN.description,onChange:e=>ey({...eN,description:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Enabled"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Zone is active"})]}),(0,s.jsx)(j.Switch,{checked:eN.enabled,onCheckedChange:e=>ey({...eN,enabled:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Read Only"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Prevent write operations"})]}),(0,s.jsx)(j.Switch,{checked:eN.read_only,onCheckedChange:e=>ey({...eN,read_only:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Browsable"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Show in network browser"})]}),(0,s.jsx)(j.Switch,{checked:eN.browsable,onCheckedChange:e=>ey({...eN,browsable:e})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Auto-Provision"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Auto-create directories for users"})]}),(0,s.jsx)(j.Switch,{checked:eN.auto_provision,onCheckedChange:e=>ey({...eN,auto_provision:e})})]})]})]}),(0,s.jsxs)(x.TabsContent,{value:"access",className:"mt-0 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Guest Access"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Allow anonymous access"})]}),(0,s.jsx)(j.Switch,{checked:eN.allow_guest_access,onCheckedChange:e=>ey({...eN,allow_guest_access:e})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"Allowed Users"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(h.Select,{value:em,onValueChange:eu,children:[(0,s.jsx)(h.SelectTrigger,{className:"flex-1",children:(0,s.jsx)(h.SelectValue,{placeholder:"Select user"})}),(0,s.jsx)(h.SelectContent,{children:Q.filter(e=>!eN.allowed_users.includes(e)).map(e=>(0,s.jsx)(h.SelectItem,{value:e,children:e},e))})]}),(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eS("allowed_users",em,eu),children:"Add"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[eN.allowed_users.map(e=>(0,s.jsxs)(t.Badge,{variant:"secondary",className:"cursor-pointer",onClick:()=>ek("allowed_users",e),children:[(0,s.jsx)(T.User,{className:"h-3 w-3 mr-1"}),e,(0,s.jsx)("span",{className:"ml-1",children:"×"})]},e)),0===eN.allowed_users.length&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"No users specified (all users allowed)"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"Allowed Groups"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(h.Select,{value:ep,onValueChange:ej,children:[(0,s.jsx)(h.SelectTrigger,{className:"flex-1",children:(0,s.jsx)(h.SelectValue,{placeholder:"Select group"})}),(0,s.jsx)(h.SelectContent,{children:J.filter(e=>!eN.allowed_groups.includes(e)).map(e=>(0,s.jsx)(h.SelectItem,{value:e,children:e},e))})]}),(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eS("allowed_groups",ep,ej),children:"Add"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[eN.allowed_groups.map(e=>(0,s.jsxs)(t.Badge,{variant:"secondary",className:"cursor-pointer",onClick:()=>ek("allowed_groups",e),children:[(0,s.jsx)(S.Users,{className:"h-3 w-3 mr-1"}),e,(0,s.jsx)("span",{className:"ml-1",children:"×"})]},e)),0===eN.allowed_groups.length&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"No groups specified"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"Denied Users"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(h.Select,{value:e_,onValueChange:eg,children:[(0,s.jsx)(h.SelectTrigger,{className:"flex-1",children:(0,s.jsx)(h.SelectValue,{placeholder:"Select user to deny"})}),(0,s.jsx)(h.SelectContent,{children:Q.filter(e=>!eN.deny_users.includes(e)).map(e=>(0,s.jsx)(h.SelectItem,{value:e,children:e},e))})]}),(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eS("deny_users",e_,eg),children:"Add"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[eN.deny_users.map(e=>(0,s.jsxs)(t.Badge,{variant:"destructive",className:"cursor-pointer",onClick:()=>ek("deny_users",e),children:[(0,s.jsx)(T.User,{className:"h-3 w-3 mr-1"}),e,(0,s.jsx)("span",{className:"ml-1",children:"×"})]},e)),0===eN.deny_users.length&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"No users denied"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"Denied Groups"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(h.Select,{value:eb,onValueChange:ew,children:[(0,s.jsx)(h.SelectTrigger,{className:"flex-1",children:(0,s.jsx)(h.SelectValue,{placeholder:"Select group to deny"})}),(0,s.jsx)(h.SelectContent,{children:J.filter(e=>!eN.deny_groups.includes(e)).map(e=>(0,s.jsx)(h.SelectItem,{value:e,children:e},e))})]}),(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eS("deny_groups",eb,ew),children:"Add"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[eN.deny_groups.map(e=>(0,s.jsxs)(t.Badge,{variant:"destructive",className:"cursor-pointer",onClick:()=>ek("deny_groups",e),children:[(0,s.jsx)(S.Users,{className:"h-3 w-3 mr-1"}),e,(0,s.jsx)("span",{className:"ml-1",children:"×"})]},e)),0===eN.deny_groups.length&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"No groups denied"})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"quota",children:"User Quota (GB)"}),(0,s.jsx)(m.Input,{id:"quota",type:"number",min:"0",placeholder:"0 = unlimited",value:eN.max_quota_per_user||"",onChange:e=>ey({...eN,max_quota_per_user:parseInt(e.target.value)||0})}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Maximum storage per user (0 = unlimited)"})]})]}),(0,s.jsxs)(x.TabsContent,{value:"smb",className:"mt-0 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(A.Server,{className:"h-4 w-4"}),"SMB/CIFS Sharing"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Windows file sharing (Samba)"})]}),(0,s.jsx)(j.Switch,{checked:eN.smb_enabled,onCheckedChange:e=>ey({...eN,smb_enabled:e})})]}),eN.smb_enabled&&(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_share_name",children:"Share Name"}),(0,s.jsx)(m.Input,{id:"smb_share_name",placeholder:eN.name||"share-name",value:eN.smb_options.share_name,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,share_name:e.target.value}})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_comment",children:"Comment"}),(0,s.jsx)(m.Input,{id:"smb_comment",placeholder:"Share description",value:eN.smb_options.comment,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,comment:e.target.value}})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_create_mask",children:"File Create Mask"}),(0,s.jsx)(m.Input,{id:"smb_create_mask",placeholder:"0644",value:eN.smb_options.create_mask,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,create_mask:e.target.value}})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_dir_mask",children:"Directory Create Mask"}),(0,s.jsx)(m.Input,{id:"smb_dir_mask",placeholder:"0755",value:eN.smb_options.directory_mask,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,directory_mask:e.target.value}})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_force_user",children:"Force User"}),(0,s.jsx)(m.Input,{id:"smb_force_user",placeholder:"nobody",value:eN.smb_options.force_user,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,force_user:e.target.value}})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_force_group",children:"Force Group"}),(0,s.jsx)(m.Input,{id:"smb_force_group",placeholder:"nogroup",value:eN.smb_options.force_group,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,force_group:e.target.value}})})]})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"smb_veto",children:"Veto Files"}),(0,s.jsx)(m.Input,{id:"smb_veto",placeholder:"/*.exe/*.bat/*.cmd/",value:eN.smb_options.veto_files,onChange:e=>ey({...eN,smb_options:{...eN.smb_options,veto_files:e.target.value}})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Files to hide/block (Samba veto pattern)"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Inherit Permissions"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"New files inherit parent permissions"})]}),(0,s.jsx)(j.Switch,{checked:eN.smb_options.inherit,onCheckedChange:e=>ey({...eN,smb_options:{...eN.smb_options,inherit:e}})})]})]})]}),(0,s.jsxs)(x.TabsContent,{value:"nfs",className:"mt-0 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(z.HardDrive,{className:"h-4 w-4"}),"NFS Sharing"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Network File System exports"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_enabled,onCheckedChange:e=>ey({...eN,nfs_enabled:e})})]}),eN.nfs_enabled&&(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Label,{children:"Allowed Hosts"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(m.Input,{placeholder:"192.168.1.0/24 or hostname",value:ef,onChange:e=>ev(e.target.value),onKeyDown:e=>"Enter"===e.key&&eT()}),(0,s.jsx)(o.Button,{variant:"outline",onClick:eT,children:"Add"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:eN.nfs_options.allowed_hosts.map(e=>(0,s.jsxs)(t.Badge,{variant:"secondary",className:"cursor-pointer",onClick:()=>{ey(s=>({...s,nfs_options:{...s.nfs_options,allowed_hosts:s.nfs_options.allowed_hosts.filter(s=>s!==e)}}))},children:[(0,s.jsx)(B.Network,{className:"h-3 w-3 mr-1"}),e,(0,s.jsx)("span",{className:"ml-1",children:"×"})]},e))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Root Squash"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Map root to nobody"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_options.root_squash,onCheckedChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,root_squash:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"All Squash"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Map all users to nobody"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_options.all_squash,onCheckedChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,all_squash:e}})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"nfs_anon_uid",children:"Anonymous UID"}),(0,s.jsx)(m.Input,{id:"nfs_anon_uid",type:"number",value:eN.nfs_options.anon_uid,onChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,anon_uid:parseInt(e.target.value)||65534}})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"nfs_anon_gid",children:"Anonymous GID"}),(0,s.jsx)(m.Input,{id:"nfs_anon_gid",type:"number",value:eN.nfs_options.anon_gid,onChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,anon_gid:parseInt(e.target.value)||65534}})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Sync"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Sync writes"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_options.sync,onCheckedChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,sync:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Secure"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Privileged ports"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_options.secure,onCheckedChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,secure:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"No Subtree"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Disable check"})]}),(0,s.jsx)(j.Switch,{checked:eN.nfs_options.no_subtree_check,onCheckedChange:e=>ey({...eN,nfs_options:{...eN.nfs_options,no_subtree_check:e}})})]})]})]})]}),(0,s.jsxs)(x.TabsContent,{value:"web",className:"mt-0 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pb-4 border-b",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(D.Link2,{className:"h-4 w-4"}),"Web Sharing"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Web-based file access and public links"})]}),(0,s.jsx)(j.Switch,{checked:eN.allow_web_shares,onCheckedChange:e=>ey({...eN,allow_web_shares:e})})]}),eN.allow_web_shares&&(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Public Link Sharing"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Allow users to create shareable links"})]}),(0,s.jsx)(j.Switch,{checked:eN.web_options.public_enabled,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,public_enabled:e}})})]}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(u.Label,{htmlFor:"web_max_expiry",children:"Max Link Expiry (days)"}),(0,s.jsx)(m.Input,{id:"web_max_expiry",type:"number",min:"0",placeholder:"0 = no limit",value:eN.web_options.max_link_expiry||"",onChange:e=>ey({...eN,web_options:{...eN.web_options,max_link_expiry:parseInt(e.target.value)||0}})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)(u.Label,{children:"Allow Download"})}),(0,s.jsx)(j.Switch,{checked:eN.web_options.allow_download,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,allow_download:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)(u.Label,{children:"Allow Upload"})}),(0,s.jsx)(j.Switch,{checked:eN.web_options.allow_upload,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,allow_upload:e}})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)(u.Label,{children:"Allow Preview"})}),(0,s.jsx)(j.Switch,{checked:eN.web_options.allow_preview,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,allow_preview:e}})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)(u.Label,{children:"Allow Listing"})}),(0,s.jsx)(j.Switch,{checked:eN.web_options.allow_listing,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,allow_listing:e}})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{children:"Require Authentication"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Users must log in for web access"})]}),(0,s.jsx)(j.Switch,{checked:eN.web_options.require_auth,onCheckedChange:e=>ey({...eN,web_options:{...eN.web_options,require_auth:e}})})]})]})]})]})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>en(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:eB,children:"Save Changes"})]})]})}),(0,s.jsx)(c.Dialog,{open:et,onOpenChange:eo,children:(0,s.jsxs)(c.DialogContent,{className:"max-w-2xl",children:[(0,s.jsx)(c.DialogHeader,{children:(0,s.jsxs)(c.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.FolderTree,{className:"h-5 w-5"}),"Zone Details: ",null==ed?void 0:ed.name]})}),ed&&(0,s.jsxs)("div",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Pool"}),(0,s.jsx)("p",{className:"font-medium",children:eA(ed.pool_id)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Path"}),(0,s.jsx)("p",{className:"font-mono text-sm",children:ed.path})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Type"}),(0,s.jsx)("div",{className:"mt-1",children:ez(ed.zone_type)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Status"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(t.Badge,{variant:ed.enabled?"default":"secondary",children:ed.enabled?"Active":"Disabled"})})]})]}),ed.description&&(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Description"}),(0,s.jsx)("p",{className:"text-sm",children:ed.description})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Sharing Protocols"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[ed.smb_enabled&&(0,s.jsxs)(t.Badge,{variant:"outline",children:[(0,s.jsx)(A.Server,{className:"h-3 w-3 mr-1"}),"SMB"]}),ed.nfs_enabled&&(0,s.jsxs)(t.Badge,{variant:"outline",children:[(0,s.jsx)(z.HardDrive,{className:"h-3 w-3 mr-1"}),"NFS"]}),ed.allow_web_shares&&(0,s.jsxs)(t.Badge,{variant:"outline",children:[(0,s.jsx)(D.Link2,{className:"h-3 w-3 mr-1"}),"Web"]}),ed.allow_guest_access&&(0,s.jsxs)(t.Badge,{variant:"outline",children:[(0,s.jsx)(k.Globe,{className:"h-3 w-3 mr-1"}),"Guest"]}),!ed.smb_enabled&&!ed.nfs_enabled&&!ed.allow_web_shares&&(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"No sharing enabled"})]})]}),((null==(e=ed.allowed_users)?void 0:e.length)>0||(null==(H=ed.allowed_groups)?void 0:H.length)>0)&&(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Access Control"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[null==(U=ed.allowed_users)?void 0:U.map(e=>(0,s.jsxs)(t.Badge,{variant:"secondary",children:[(0,s.jsx)(T.User,{className:"h-3 w-3 mr-1"}),e]},e)),null==(Z=ed.allowed_groups)?void 0:Z.map(e=>(0,s.jsxs)(t.Badge,{variant:"secondary",children:[(0,s.jsx)(S.Users,{className:"h-3 w-3 mr-1"}),e]},e))]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Created"}),(0,s.jsx)("p",{children:new Date(ed.created_at).toLocaleString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(u.Label,{className:"text-muted-foreground",children:"Updated"}),(0,s.jsx)("p",{children:new Date(ed.updated_at).toLocaleString()})]})]})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eo(!1),children:"Close"}),(0,s.jsxs)(o.Button,{onClick:()=>{eo(!1),ed&&eL(ed)},children:[(0,s.jsx)(y.Pencil,{className:"h-4 w-4 mr-2"}),"Edit Zone"]})]})]})}),(0,s.jsx)(c.Dialog,{open:ei,onOpenChange:er,children:(0,s.jsxs)(c.DialogContent,{children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsxs)(c.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(L.AlertTriangle,{className:"h-5 w-5 text-red-500"}),"Delete Share Zone"]}),(0,s.jsxs)(c.DialogDescription,{children:['Are you sure you want to delete the share zone "',null==ed?void 0:ed.name,'"? This action cannot be undone. All shares in this zone must be deleted first.']})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>er(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{variant:"destructive",onClick:eD,children:"Delete Zone"})]})]})})]})}}]);