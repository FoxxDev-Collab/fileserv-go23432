(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79887,e=>{"use strict";e.s(["default",()=>U],79887);var s=e.i(18050),a=e.i(71645),l=e.i(18566),t=e.i(49786),n=e.i(81868),r=e.i(70065),i=e.i(94179),o=e.i(67881),c=e.i(81947),d=e.i(23750),h=e.i(10708),m=e.i(10939),x=e.i(62870),u=e.i(25959),j=e.i(91432),p=e.i(54858);e.i(73827);var g=e.i(59467),v=e.i(46696),f=e.i(27341),N=e.i(47627),b=e.i(30374),y=e.i(63415),C=e.i(58041),w=e.i(52786),T=e.i(16715),D=e.i(7233),S=e.i(27612),k=e.i(40160),I=e.i(69638),F=e.i(73884),A=e.i(78894),P=e.i(31278),B=e.i(52571),z=e.i(98919),H=e.i(75505),L=e.i(75254);let M=(0,L.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var R=e.i(67240),Z=e.i(69074),E=e.i(31343),q=e.i(52044),_=e.i(23585);let O=(0,L.default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);function V(e){if(0===e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB","PB"][s]}function U(){let e=(0,l.useRouter)(),{user:L,isAuthenticated:U,isLoading:G}=(0,j.useAuth)(),[K,Q]=(0,a.useState)(null),[J,W]=(0,a.useState)([]),[X,Y]=(0,a.useState)([]),[$,ee]=(0,a.useState)([]),[es,ea]=(0,a.useState)([]),[el,et]=(0,a.useState)([]),[en,er]=(0,a.useState)(null),[ei,eo]=(0,a.useState)(!0),[ec,ed]=(0,a.useState)(!1),[eh,em]=(0,a.useState)(!1),[ex,eu]=(0,a.useState)(!1),[ej,ep]=(0,a.useState)(!1),[eg,ev]=(0,a.useState)(!1),[ef,eN]=(0,a.useState)(!1),[eb,ey]=(0,a.useState)(!1),[eC,ew]=(0,a.useState)(!1),[eT,eD]=(0,a.useState)({name:"",vdev_type:"stripe",devices:[],mountpoint:"",force:!1}),[eS,ek]=(0,a.useState)({name:"",mountpoint:"",compression:"lz4",quota:""}),[eI,eF]=(0,a.useState)({dataset:"",name:"",recursive:!1}),[eA,eP]=(0,a.useState)(!1),[eB,ez]=(0,a.useState)(!1),[eH,eL]=(0,a.useState)(!1),[eM,eR]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!G){if(!U)return void e.replace("/");L&&"user"===L.role&&e.replace("/dashboard")}},[G,U,L,e]);let eZ=async()=>{try{let e=await p.zfsAPI.getStatus();if(Q(e),e.installed&&e.kernel_module){let[e,s,a,l]=await Promise.all([p.zfsAPI.listPools().catch(()=>[]),p.zfsAPI.listDatasets().catch(()=>[]),p.zfsAPI.listSnapshots().catch(()=>[]),p.zfsAPI.getAvailableDisks().catch(()=>[])]);W(e),Y(s),ee(a),ea(l);try{let e=await p.zfsAPI.listImportablePools();et(e)}catch(e){et([])}}}catch(e){v.toast.error("Failed to load ZFS data: ".concat(e))}finally{eo(!1),ed(!1)}};(0,a.useEffect)(()=>{U&&(null==L?void 0:L.role)==="admin"&&eZ()},[U,L]);let eE=(0,a.useCallback)(e=>{em(!1),e?(v.toast.success("ZFS installed successfully"),eZ()):v.toast.error("ZFS installation failed - check the output above for details")},[]),eq=async()=>{eu(!0);try{let e=await p.zfsAPI.loadModule();v.toast.success(e.message),eZ()}catch(e){v.toast.error("Failed to load ZFS module: ".concat(e))}finally{eu(!1)}},e_=async()=>{if(!eT.name||0===eT.devices.length)return void v.toast.error("Pool name and at least one device are required");eP(!0);try{await p.zfsAPI.createPool({name:eT.name,vdev_type:eT.vdev_type,devices:eT.devices,mountpoint:eT.mountpoint||void 0,force:eT.force}),v.toast.success("Pool ".concat(eT.name," created successfully")),ep(!1),eD({name:"",vdev_type:"stripe",devices:[],mountpoint:"",force:!1}),eZ()}catch(e){v.toast.error("Failed to create pool: ".concat(e))}finally{eP(!1)}},eO=async e=>{if(confirm('Are you sure you want to destroy pool "'.concat(e,'"? This will DELETE ALL DATA in the pool!')))try{await p.zfsAPI.destroyPool(e,!0),v.toast.success("Pool ".concat(e," destroyed")),eZ()}catch(e){v.toast.error("Failed to destroy pool: ".concat(e))}},eV=async(e,s)=>{try{await p.zfsAPI.scrubPool(e,s),v.toast.success("Scrub ".concat(s,"ed for pool ").concat(e)),eZ()}catch(e){v.toast.error("Failed to ".concat(s," scrub: ").concat(e))}},eU=async e=>{if(confirm('Export pool "'.concat(e,'"? It will be unmounted and made unavailable.')))try{await p.zfsAPI.exportPool(e),v.toast.success("Pool ".concat(e," exported")),eZ()}catch(e){v.toast.error("Failed to export pool: ".concat(e))}},eG=async e=>{try{await p.zfsAPI.importPool(e),v.toast.success(e?"Pool ".concat(e," imported"):"All pools imported"),ew(!1),eZ()}catch(e){v.toast.error("Failed to import pool: ".concat(e))}},eK=async e=>{try{let s=await p.zfsAPI.getPoolStatus(e);er(s),ey(!0)}catch(e){v.toast.error("Failed to get pool status: ".concat(e))}},eQ=async()=>{if(!eS.name)return void v.toast.error("Dataset name is required (format: pool/dataset)");ez(!0);try{await p.zfsAPI.createDataset({name:eS.name,mountpoint:eS.mountpoint||void 0,compression:eS.compression||void 0,quota:eS.quota||void 0}),v.toast.success("Dataset ".concat(eS.name," created successfully")),ev(!1),ek({name:"",mountpoint:"",compression:"lz4",quota:""}),eZ()}catch(e){v.toast.error("Failed to create dataset: ".concat(e))}finally{ez(!1)}},eJ=async e=>{if(confirm('Are you sure you want to destroy dataset "'.concat(e,'"? This will DELETE ALL DATA!')))try{await p.zfsAPI.destroyDataset(e,!0,!0),v.toast.success("Dataset ".concat(e," destroyed")),eZ()}catch(e){v.toast.error("Failed to destroy dataset: ".concat(e))}},eW=async()=>{if(!eI.dataset||!eI.name)return void v.toast.error("Dataset and snapshot name are required");eL(!0);try{await p.zfsAPI.createSnapshot(eI.dataset,eI.name,eI.recursive),v.toast.success("Snapshot created successfully"),eN(!1),eF({dataset:"",name:"",recursive:!1}),eZ()}catch(e){v.toast.error("Failed to create snapshot: ".concat(e))}finally{eL(!1)}},eX=async e=>{if(confirm('Delete snapshot "'.concat(e,'"?')))try{await p.zfsAPI.deleteSnapshot(e),v.toast.success("Snapshot ".concat(e," deleted")),eZ()}catch(e){v.toast.error("Failed to delete snapshot: ".concat(e))}},eY=async e=>{if(confirm('Rollback to snapshot "'.concat(e,'"? This will revert the dataset to this point in time and destroy all newer snapshots!')))try{await p.zfsAPI.rollbackSnapshot(e,!0,!1,!0),v.toast.success("Rolled back to snapshot ".concat(e)),eZ()}catch(e){v.toast.error("Failed to rollback: ".concat(e))}};return G&&!L||!U||L&&"admin"!==L.role||ei?(0,s.jsx)(g.PageSkeleton,{title:"ZFS Storage"}):(0,s.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,s.jsx)(n.Sidebar,{}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(t.Header,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"ZFS Storage Management"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage ZFS pools, datasets, and snapshots"})]}),(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>{ed(!0),eZ()},disabled:ec,children:[(0,s.jsx)(T.RefreshCw,{className:"h-4 w-4 mr-2 ".concat(ec?"animate-spin":"")}),"Refresh"]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(C.Database,{className:"h-10 w-10 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.CardTitle,{className:"text-lg",children:"ZFS (Zettabyte File System)"}),(0,s.jsx)(r.CardDescription,{children:"Advanced storage management with data integrity"})]})]}),(null==K?void 0:K.installed)&&(null==K?void 0:K.kernel_module)?(0,s.jsx)(I.CheckCircle,{className:"h-8 w-8 text-green-500"}):(null==K?void 0:K.installed)?(0,s.jsx)(A.AlertTriangle,{className:"h-8 w-8 text-yellow-500"}):(0,s.jsx)(F.XCircle,{className:"h-8 w-8 text-muted-foreground"})]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(null==K?void 0:K.installed)?(null==K?void 0:K.kernel_module)?(0,s.jsx)(i.Badge,{variant:"default",className:"bg-green-600",children:"Ready"}):(0,s.jsx)(i.Badge,{variant:"outline",className:"text-yellow-600 border-yellow-600",children:"Module Not Loaded"}):(0,s.jsx)(i.Badge,{variant:"secondary",children:"Not Installed"}),(null==K?void 0:K.version)&&(0,s.jsxs)(i.Badge,{variant:"outline",children:["v",K.version]}),J.length>0&&(0,s.jsxs)(i.Badge,{variant:"secondary",children:[J.length," pool(s)"]})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:null==K?void 0:K.message}),(null==K?void 0:K.installed)?(null==K?void 0:K.kernel_module)?null:(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(o.Button,{onClick:eq,disabled:ex,children:ex?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Loading Module..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O,{className:"h-4 w-4 mr-2"}),"Load ZFS Kernel Module"]})})}):(0,s.jsx)("div",{className:"pt-2",children:(null==K?void 0:K.can_install)?(0,s.jsx)(o.Button,{onClick:()=>{em(!0),eR(!0)},disabled:eh,className:"w-full",children:eh?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Installing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(k.Download,{className:"h-4 w-4 mr-2"}),"Install ",K.package_name]})}):(0,s.jsxs)(c.Alert,{children:[(0,s.jsx)(z.Shield,{className:"h-4 w-4"}),(0,s.jsx)(c.AlertTitle,{children:"Installation Required"}),(0,s.jsxs)(c.AlertDescription,{children:["Run the following command as root to install:",(0,s.jsx)("code",{className:"block mt-2 p-2 bg-muted rounded text-xs",children:(null==K?void 0:K.package_manager)==="apt"?"sudo apt install ".concat(null==K?void 0:K.package_name):"sudo dnf install ".concat(null==K?void 0:K.package_name)})]})]})})]})]}),eM&&(0,s.jsx)(m.TerminalOutput,{url:"/api/zfs/install/stream",title:"ZFS Installation",onComplete:eE,onClose:()=>{eR(!1),eZ()}}),(null==K?void 0:K.installed)&&(null==K?void 0:K.kernel_module)&&(0,s.jsxs)(f.Tabs,{defaultValue:"pools",className:"space-y-4",children:[(0,s.jsxs)(f.TabsList,{children:[(0,s.jsxs)(f.TabsTrigger,{value:"pools",className:"gap-2",children:[(0,s.jsx)(w.HardDrive,{className:"h-4 w-4"}),"Pools",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:J.length})]}),(0,s.jsxs)(f.TabsTrigger,{value:"datasets",className:"gap-2",children:[(0,s.jsx)(H.FolderOpen,{className:"h-4 w-4"}),"Datasets",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:X.length})]}),(0,s.jsxs)(f.TabsTrigger,{value:"snapshots",className:"gap-2",children:[(0,s.jsx)(M,{className:"h-4 w-4"}),"Snapshots",(0,s.jsx)(i.Badge,{variant:"secondary",className:"ml-1",children:$.length})]})]}),(0,s.jsxs)(f.TabsContent,{value:"pools",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Storage Pools"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[el.length>0&&(0,s.jsxs)(o.Button,{variant:"outline",size:"sm",onClick:()=>ew(!0),children:[(0,s.jsx)(Z.Upload,{className:"h-4 w-4 mr-2"}),"Import Pool (",el.length,")"]}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>ep(!0),children:[(0,s.jsx)(D.Plus,{className:"h-4 w-4 mr-2"}),"Create Pool"]})]})]}),0===J.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(w.HardDrive,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No ZFS pools configured"}),(0,s.jsx)("p",{className:"text-sm",children:"Create a pool to get started with ZFS storage"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(N.Table,{children:[(0,s.jsx)(N.TableHeader,{children:(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableHead,{children:"Name"}),(0,s.jsx)(N.TableHead,{children:"Size"}),(0,s.jsx)(N.TableHead,{children:"Used"}),(0,s.jsx)(N.TableHead,{children:"Free"}),(0,s.jsx)(N.TableHead,{children:"Health"}),(0,s.jsx)(N.TableHead,{children:"Fragmentation"}),(0,s.jsx)(N.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(N.TableBody,{children:J.map(e=>(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableCell,{className:"font-medium",children:e.name}),(0,s.jsx)(N.TableCell,{children:V(e.size)}),(0,s.jsx)(N.TableCell,{children:V(e.allocated)}),(0,s.jsx)(N.TableCell,{children:V(e.free)}),(0,s.jsx)(N.TableCell,{children:(e=>{switch(e.toUpperCase()){case"ONLINE":return(0,s.jsx)(i.Badge,{variant:"default",className:"bg-green-600",children:"ONLINE"});case"DEGRADED":return(0,s.jsx)(i.Badge,{variant:"default",className:"bg-yellow-600",children:"DEGRADED"});case"FAULTED":return(0,s.jsx)(i.Badge,{variant:"destructive",children:"FAULTED"});case"OFFLINE":return(0,s.jsx)(i.Badge,{variant:"secondary",children:"OFFLINE"});default:return(0,s.jsx)(i.Badge,{variant:"outline",children:e})}})(e.health)}),(0,s.jsx)(N.TableCell,{children:e.fragmentation}),(0,s.jsx)(N.TableCell,{className:"text-right",children:(0,s.jsxs)(y.DropdownMenu,{children:[(0,s.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(_.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(y.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eK(e.name),children:[(0,s.jsx)(B.Info,{className:"h-4 w-4 mr-2"}),"View Status"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eV(e.name,"start"),children:[(0,s.jsx)(E.Play,{className:"h-4 w-4 mr-2"}),"Start Scrub"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eV(e.name,"stop"),children:[(0,s.jsx)(q.Square,{className:"h-4 w-4 mr-2"}),"Stop Scrub"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eU(e.name),children:[(0,s.jsx)(k.Download,{className:"h-4 w-4 mr-2"}),"Export Pool"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eO(e.name),className:"text-red-600",children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Destroy Pool"]})]})]})})]},e.name))})]})})]}),(0,s.jsxs)(f.TabsContent,{value:"datasets",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Datasets"}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>ev(!0),disabled:0===J.length,children:[(0,s.jsx)(D.Plus,{className:"h-4 w-4 mr-2"}),"Create Dataset"]})]}),0===X.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(H.FolderOpen,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No datasets found"}),(0,s.jsx)("p",{className:"text-sm",children:"Create a pool first, then add datasets"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(N.Table,{children:[(0,s.jsx)(N.TableHeader,{children:(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableHead,{children:"Name"}),(0,s.jsx)(N.TableHead,{children:"Used"}),(0,s.jsx)(N.TableHead,{children:"Available"}),(0,s.jsx)(N.TableHead,{children:"Mountpoint"}),(0,s.jsx)(N.TableHead,{children:"Compression"}),(0,s.jsx)(N.TableHead,{children:"Quota"}),(0,s.jsx)(N.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(N.TableBody,{children:X.map(e=>(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableCell,{className:"font-medium font-mono text-sm",children:e.name}),(0,s.jsx)(N.TableCell,{children:V(e.used)}),(0,s.jsx)(N.TableCell,{children:V(e.available)}),(0,s.jsx)(N.TableCell,{className:"font-mono text-sm",children:e.mountpoint}),(0,s.jsx)(N.TableCell,{children:(0,s.jsx)(i.Badge,{variant:"outline",children:e.compression})}),(0,s.jsx)(N.TableCell,{children:e.quota?"number"==typeof e.quota?V(e.quota):e.quota:"-"}),(0,s.jsx)(N.TableCell,{className:"text-right",children:(0,s.jsxs)(y.DropdownMenu,{children:[(0,s.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(_.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(y.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>{eF({dataset:e.name,name:"",recursive:!1}),eN(!0)},children:[(0,s.jsx)(M,{className:"h-4 w-4 mr-2"}),"Create Snapshot"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eJ(e.name),className:"text-red-600",children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Destroy Dataset"]})]})]})})]},e.name))})]})})]}),(0,s.jsxs)(f.TabsContent,{value:"snapshots",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Snapshots"}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>eN(!0),disabled:0===X.length,children:[(0,s.jsx)(D.Plus,{className:"h-4 w-4 mr-2"}),"Create Snapshot"]})]}),0===$.length?(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardContent,{className:"py-8 text-center text-muted-foreground",children:[(0,s.jsx)(M,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,s.jsx)("p",{children:"No snapshots found"}),(0,s.jsx)("p",{className:"text-sm",children:"Create snapshots to preserve point-in-time copies of your data"})]})}):(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(N.Table,{children:[(0,s.jsx)(N.TableHeader,{children:(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableHead,{children:"Name"}),(0,s.jsx)(N.TableHead,{children:"Dataset"}),(0,s.jsx)(N.TableHead,{children:"Used"}),(0,s.jsx)(N.TableHead,{children:"Referenced"}),(0,s.jsx)(N.TableHead,{children:"Created"}),(0,s.jsx)(N.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(N.TableBody,{children:$.map(e=>(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableCell,{className:"font-medium font-mono text-sm",children:e.name}),(0,s.jsx)(N.TableCell,{className:"font-mono text-sm",children:e.dataset}),(0,s.jsx)(N.TableCell,{children:V(e.used)}),(0,s.jsx)(N.TableCell,{children:V(e.referenced)}),(0,s.jsx)(N.TableCell,{children:e.creation}),(0,s.jsx)(N.TableCell,{className:"text-right",children:(0,s.jsxs)(y.DropdownMenu,{children:[(0,s.jsx)(y.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(o.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(_.MoreVertical,{className:"h-4 w-4"})})}),(0,s.jsxs)(y.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eY(e.name),children:[(0,s.jsx)(R.RotateCcw,{className:"h-4 w-4 mr-2"}),"Rollback"]}),(0,s.jsxs)(y.DropdownMenuItem,{onClick:()=>eX(e.name),className:"text-red-600",children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},e.name))})]})})]})]}),(0,s.jsxs)(r.Card,{children:[(0,s.jsx)(r.CardHeader,{children:(0,s.jsxs)(r.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,s.jsx)(B.Info,{className:"h-5 w-5"}),"About ZFS"]})}),(0,s.jsxs)(r.CardContent,{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"ZFS is an advanced filesystem and volume manager with built-in data integrity verification, copy-on-write snapshots, and RAID-Z redundancy. It combines the roles of a filesystem and volume manager, providing powerful features for data protection and storage efficiency."}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Pools"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pools combine multiple disks into a single storage unit. They can use striping, mirroring, or RAID-Z configurations for performance and redundancy."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Datasets"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Datasets are flexible filesystem containers within a pool. They share pool space and can have individual quotas, compression, and mount options."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Snapshots"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Snapshots are instant, space-efficient point-in-time copies. They only use space when data changes, making them ideal for backups and testing."})]})]})]})]})]})})]}),(0,s.jsx)(b.Dialog,{open:ej,onOpenChange:ep,children:(0,s.jsxs)(b.DialogContent,{className:"max-w-lg",children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsx)(b.DialogTitle,{children:"Create ZFS Pool"}),(0,s.jsx)(b.DialogDescription,{children:"Create a new storage pool from available disks"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"pool-name",children:"Pool Name"}),(0,s.jsx)(d.Input,{id:"pool-name",placeholder:"mypool",value:eT.name,onChange:e=>eD({...eT,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"vdev-type",children:"VDEV Type"}),(0,s.jsxs)(x.Select,{value:eT.vdev_type,onValueChange:e=>eD({...eT,vdev_type:e}),children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select type"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"stripe",children:"Stripe (no redundancy)"}),(0,s.jsx)(x.SelectItem,{value:"mirror",children:"Mirror (2+ disks)"}),(0,s.jsx)(x.SelectItem,{value:"raidz1",children:"RAID-Z1 (3+ disks, 1 parity)"}),(0,s.jsx)(x.SelectItem,{value:"raidz2",children:"RAID-Z2 (4+ disks, 2 parity)"}),(0,s.jsx)(x.SelectItem,{value:"raidz3",children:"RAID-Z3 (5+ disks, 3 parity)"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{children:"Available Disks"}),0===es.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No available disks found"}):(0,s.jsx)("div",{className:"border rounded-lg max-h-48 overflow-y-auto",children:es.filter(e=>!e.in_use).map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border-b last:border-b-0",children:[(0,s.jsx)(u.Checkbox,{id:e.path,checked:eT.devices.includes(e.path),onCheckedChange:s=>{s?eD({...eT,devices:[...eT.devices,e.path]}):eD({...eT,devices:eT.devices.filter(s=>s!==e.path)})}}),(0,s.jsxs)("label",{htmlFor:e.path,className:"flex-1 cursor-pointer",children:[(0,s.jsx)("div",{className:"font-mono text-sm",children:e.path}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[V(e.size)," - ",e.model||e.type]})]})]},e.path))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"mountpoint",children:"Mount Point (optional)"}),(0,s.jsx)(d.Input,{id:"mountpoint",placeholder:"/mnt/mypool",value:eT.mountpoint,onChange:e=>eD({...eT,mountpoint:e.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Checkbox,{id:"force",checked:eT.force,onCheckedChange:e=>eD({...eT,force:!!e})}),(0,s.jsx)("label",{htmlFor:"force",className:"text-sm",children:"Force creation (use with caution)"})]})]}),(0,s.jsxs)(b.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ep(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:e_,disabled:eA||0===eT.devices.length,children:eA?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Pool"})]})]})}),(0,s.jsx)(b.Dialog,{open:eg,onOpenChange:ev,children:(0,s.jsxs)(b.DialogContent,{children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsx)(b.DialogTitle,{children:"Create Dataset"}),(0,s.jsx)(b.DialogDescription,{children:"Create a new dataset within an existing pool"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"dataset-name",children:"Dataset Name"}),(0,s.jsx)(d.Input,{id:"dataset-name",placeholder:"pool/dataset",value:eS.name,onChange:e=>ek({...eS,name:e.target.value})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Format: poolname/datasetname (e.g., mypool/documents)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"ds-mountpoint",children:"Mount Point (optional)"}),(0,s.jsx)(d.Input,{id:"ds-mountpoint",placeholder:"/mnt/mypool/documents",value:eS.mountpoint,onChange:e=>ek({...eS,mountpoint:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"compression",children:"Compression"}),(0,s.jsxs)(x.Select,{value:eS.compression,onValueChange:e=>ek({...eS,compression:e}),children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select compression"})}),(0,s.jsxs)(x.SelectContent,{children:[(0,s.jsx)(x.SelectItem,{value:"off",children:"Off"}),(0,s.jsx)(x.SelectItem,{value:"lz4",children:"LZ4 (recommended)"}),(0,s.jsx)(x.SelectItem,{value:"gzip",children:"GZIP"}),(0,s.jsx)(x.SelectItem,{value:"zstd",children:"ZSTD"}),(0,s.jsx)(x.SelectItem,{value:"lzjb",children:"LZJB"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"quota",children:"Quota (optional)"}),(0,s.jsx)(d.Input,{id:"quota",placeholder:"10G, 500M, etc.",value:eS.quota,onChange:e=>ek({...eS,quota:e.target.value})})]})]}),(0,s.jsxs)(b.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ev(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:eQ,disabled:eB||!eS.name,children:eB?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Dataset"})]})]})}),(0,s.jsx)(b.Dialog,{open:ef,onOpenChange:eN,children:(0,s.jsxs)(b.DialogContent,{children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsx)(b.DialogTitle,{children:"Create Snapshot"}),(0,s.jsx)(b.DialogDescription,{children:"Create a point-in-time snapshot of a dataset"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"snap-dataset",children:"Dataset"}),(0,s.jsxs)(x.Select,{value:eI.dataset,onValueChange:e=>eF({...eI,dataset:e}),children:[(0,s.jsx)(x.SelectTrigger,{children:(0,s.jsx)(x.SelectValue,{placeholder:"Select dataset"})}),(0,s.jsx)(x.SelectContent,{children:X.map(e=>(0,s.jsx)(x.SelectItem,{value:e.name,children:e.name},e.name))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.Label,{htmlFor:"snap-name",children:"Snapshot Name"}),(0,s.jsx)(d.Input,{id:"snap-name",placeholder:"snap-2024-01-01",value:eI.name,onChange:e=>eF({...eI,name:e.target.value})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Checkbox,{id:"recursive",checked:eI.recursive,onCheckedChange:e=>eF({...eI,recursive:!!e})}),(0,s.jsx)("label",{htmlFor:"recursive",className:"text-sm",children:"Recursive (include child datasets)"})]})]}),(0,s.jsxs)(b.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>eN(!1),children:"Cancel"}),(0,s.jsx)(o.Button,{onClick:eW,disabled:eH||!eI.dataset||!eI.name,children:eH?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):"Create Snapshot"})]})]})}),(0,s.jsx)(b.Dialog,{open:eb,onOpenChange:ey,children:(0,s.jsxs)(b.DialogContent,{className:"max-w-2xl",children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsxs)(b.DialogTitle,{children:["Pool Status: ",null==en?void 0:en.name]}),(0,s.jsx)(b.DialogDescription,{children:"Detailed status and configuration"})]}),en&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"State"}),(0,s.jsx)("p",{className:"font-medium",children:en.state})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Status"}),(0,s.jsx)("p",{className:"font-medium",children:en.status||"OK"})]})]}),en.scan&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Last Scan"}),(0,s.jsx)("p",{className:"text-sm",children:en.scan})]}),en.action&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground",children:"Action"}),(0,s.jsx)("p",{className:"text-sm",children:en.action})]}),en.config&&en.config.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{className:"text-muted-foreground mb-2 block",children:"Configuration"}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsxs)(N.Table,{children:[(0,s.jsx)(N.TableHeader,{children:(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableHead,{children:"Name"}),(0,s.jsx)(N.TableHead,{children:"State"}),(0,s.jsx)(N.TableHead,{children:"Read"}),(0,s.jsx)(N.TableHead,{children:"Write"}),(0,s.jsx)(N.TableHead,{children:"Cksum"})]})}),(0,s.jsx)(N.TableBody,{children:en.config.map((e,a)=>(0,s.jsxs)(N.TableRow,{children:[(0,s.jsx)(N.TableCell,{className:"font-mono text-sm",style:{paddingLeft:"".concat(16*e.indent+12,"px")},children:e.name}),(0,s.jsx)(N.TableCell,{children:e.state}),(0,s.jsx)(N.TableCell,{children:e.read}),(0,s.jsx)(N.TableCell,{children:e.write}),(0,s.jsx)(N.TableCell,{children:e.cksum})]},a))})]})})]}),en.errors&&"No known data errors"!==en.errors&&(0,s.jsxs)(c.Alert,{variant:"destructive",children:[(0,s.jsx)(A.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)(c.AlertTitle,{children:"Errors Detected"}),(0,s.jsx)(c.AlertDescription,{children:en.errors})]})]}),(0,s.jsx)(b.DialogFooter,{children:(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ey(!1),children:"Close"})})]})}),(0,s.jsx)(b.Dialog,{open:eC,onOpenChange:ew,children:(0,s.jsxs)(b.DialogContent,{children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsx)(b.DialogTitle,{children:"Import ZFS Pool"}),(0,s.jsx)(b.DialogDescription,{children:"Import a previously exported or disconnected pool"})]}),(0,s.jsx)("div",{className:"space-y-4",children:0===el.length?(0,s.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No importable pools found"}):(0,s.jsx)("div",{className:"space-y-2",children:el.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["ID: ",e.id," - State: ",e.state]})]}),(0,s.jsxs)(o.Button,{size:"sm",onClick:()=>eG(e.name),children:[(0,s.jsx)(Z.Upload,{className:"h-4 w-4 mr-2"}),"Import"]})]},e.id))})}),(0,s.jsxs)(b.DialogFooter,{children:[(0,s.jsx)(o.Button,{variant:"outline",onClick:()=>ew(!1),children:"Close"}),(0,s.jsx)(o.Button,{onClick:()=>eG(),disabled:0===el.length,children:"Import All"})]})]})})]})}}]);